{"version":3,"sources":["webpack:///./src/pages/mobile/RedeemBalance.vue?c27f","webpack:///./src/pages/mobile/RedeemBalance.vue?ed16","webpack:///./src/pages/mobile/RedeemBalance.vue?7eeb","webpack:///./src/pages/mobile/RedeemBalance.vue","webpack:///src/pages/mobile/RedeemBalance.vue"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_RedeemBalance_vue_vue_type_style_index_0_id_acc8fa5c_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_RedeemBalance_vue_vue_type_style_index_0_id_acc8fa5c_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","header-fill","right-button-to","name","right-button-icon-name","slot","template","$t","_v","_s","balance","_l","account","_b","key","address","border-dark","on","click","$event","sendToAccount","staticRenderFns","mobile_RedeemBalancevue_type_script_lang_js_","RedeemBalancevue_type_script_lang_js_","component","Object","componentNormalizer","__webpack_exports__","components","AeSpinner","_components_AeSpinner_vue__WEBPACK_IMPORTED_MODULE_8__","MobilePage","_components_mobile_Page_vue__WEBPACK_IMPORTED_MODULE_9__","Guide","_components_Guide_vue__WEBPACK_IMPORTED_MODULE_10__","Balance","_components_Balance_vue__WEBPACK_IMPORTED_MODULE_11__","ListItemAccount","_components_ListItemAccount_vue__WEBPACK_IMPORTED_MODULE_12__","LeftMore","_components_icons__WEBPACK_IMPORTED_MODULE_13__","data","keypair","busy","subscriptions","lodash_es__WEBPACK_IMPORTED_MODULE_2__","$store","state","observables","mounted","_this","bluebird__WEBPACK_IMPORTED_MODULE_1__","regeneratorRuntime","mark","_callee","wrap","_context","prev","next","readQrCode","t0","$router","push","message","_lib_utils__WEBPACK_IMPORTED_MODULE_7__","abrupt","stop","methods","_this2","_callee2","privateKey","_context2","dispatch","title","sent","Buffer","from","error","length","text","_aeternity_aepp_sdk_es__WEBPACK_IMPORTED_MODULE_4__","aeEncodeKey","generateKeyPairFromSecret","publicKey","bignumber_js__WEBPACK_IMPORTED_MODULE_3___default","a","sdk","getBalance","t1","t2","_lib_constants__WEBPACK_IMPORTED_MODULE_14__","shiftedBy","accountTo","_this3","_callee3","_ref","hash","amount","_context3","_aeternity_aepp_sdk_es__WEBPACK_IMPORTED_MODULE_5__","compose","_aeternity_aepp_sdk_es__WEBPACK_IMPORTED_MODULE_6__","sign","Promise","resolve","url","sdkUrl","transferFunds","tx","transactionHash"],"mappings":"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","file":"js/page-redeem.95da7334.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RedeemBalance.vue?vue&type=style&index=0&id=acc8fa5c&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RedeemBalance.vue?vue&type=style&index=0&id=acc8fa5c&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.busy)?_c('div',{staticClass:\"spinner\"},[_c('AeSpinner')],1):_c('MobilePage',{staticClass:\"redeem-balance\",attrs:{\"header-fill\":\"neutral\",\"right-button-to\":{ name: 'transfer' },\"right-button-icon-name\":\"close\"}},[_c('Guide',{attrs:{\"slot\":\"header\",\"template\":_vm.$t('transfer.redeem-balance.guide')},slot:\"header\"}),_c('div',{staticClass:\"balance-row\"},[_c('span',[_vm._v(_vm._s(_vm.$t('transfer.send.amount.balance')))]),_c('Balance',{attrs:{\"balance\":_vm.balance}})],1),_vm._l((_vm.accounts),function(account){return _c('ListItemAccount',_vm._b({key:account.address,attrs:{\"border-dark\":\"\"},on:{\"click\":function($event){return _vm.sendToAccount(account.address)}}},'ListItemAccount',account,false),[_c('LeftMore',{attrs:{\"slot\":\"right\"},slot:\"right\"})],1)})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RedeemBalance.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RedeemBalance.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RedeemBalance.vue?vue&type=template&id=acc8fa5c&scoped=true&\"\nimport script from \"./RedeemBalance.vue?vue&type=script&lang=js&\"\nexport * from \"./RedeemBalance.vue?vue&type=script&lang=js&\"\nimport style0 from \"./RedeemBalance.vue?vue&type=style&index=0&id=acc8fa5c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"acc8fa5c\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div\n    v-if=\"busy\"\n    class=\"spinner\"\n  >\n    <AeSpinner />\n  </div>\n  <MobilePage\n    v-else\n    header-fill=\"neutral\"\n    :right-button-to=\"{ name: 'transfer' }\"\n    right-button-icon-name=\"close\"\n    class=\"redeem-balance\"\n  >\n    <Guide\n      slot=\"header\"\n      :template=\"$t('transfer.redeem-balance.guide')\"\n    />\n\n    <div class=\"balance-row\">\n      <span>{{ $t('transfer.send.amount.balance') }}</span>\n      <Balance :balance=\"balance\" />\n    </div>\n\n    <ListItemAccount\n      v-for=\"account in accounts\"\n      :key=\"account.address\"\n      border-dark\n      v-bind=\"account\"\n      @click=\"sendToAccount(account.address)\"\n    >\n      <LeftMore slot=\"right\" />\n    </ListItemAccount>\n  </MobilePage>\n</template>\n\n<script>\nimport { pick } from 'lodash-es';\nimport BigNumber from 'bignumber.js';\nimport { Ae, Transaction, Crypto } from '@aeternity/aepp-sdk/es';\nimport { handleUnknownError } from '../../lib/utils';\nimport AeSpinner from '../../components/AeSpinner.vue';\nimport MobilePage from '../../components/mobile/Page.vue';\nimport Guide from '../../components/Guide.vue';\nimport Balance from '../../components/Balance.vue';\nimport ListItemAccount from '../../components/ListItemAccount.vue';\nimport { LeftMore } from '../../components/icons';\nimport { MIN_SPEND_TX_FEE, MAGNITUDE } from '../../lib/constants';\n\nexport default {\n  components: {\n    AeSpinner,\n    MobilePage,\n    Guide,\n    Balance,\n    ListItemAccount,\n    LeftMore,\n  },\n  data: () => ({\n    keypair: null,\n    balance: 0,\n    busy: true,\n  }),\n  subscriptions() {\n    return pick(this.$store.state.observables, ['accounts']);\n  },\n  async mounted() {\n    while (!this.keypair) {\n      try {\n        await this.readQrCode(); // eslint-disable-line no-await-in-loop\n      } catch (error) {\n        this.$router.push({ name: 'transfer' });\n        if (error.message !== 'Cancelled by user') handleUnknownError(error);\n        return;\n      }\n    }\n    this.busy = false;\n  },\n  methods: {\n    async readQrCode() {\n      let privateKey;\n      privateKey = await this.$store.dispatch('modals/open', {\n        name: 'readQrCode',\n        title: this.$t('transfer.redeem-balance.scan'),\n      });\n\n      try {\n        privateKey = Buffer.from(privateKey, 'hex');\n      } catch (error) {\n        handleUnknownError(error);\n        privateKey = Buffer.from([]);\n      }\n\n      if (privateKey.length !== 64) {\n        await this.$store.dispatch('modals/open', {\n          name: 'alert',\n          text: this.$t('transfer.redeem-balance.wrong-qr-code'),\n        });\n        return;\n      }\n\n      const address = Crypto.aeEncodeKey(Crypto.generateKeyPairFromSecret(privateKey).publicKey);\n      this.balance = BigNumber(await this.$store.state.sdk.getBalance(address))\n        .shiftedBy(-MAGNITUDE);\n      if (this.balance < MIN_SPEND_TX_FEE) {\n        await this.$store.dispatch('modals/open', {\n          name: 'alert',\n          text: this.$t('transfer.redeem-balance.no-funds'),\n        });\n        return;\n      }\n\n      this.keypair = { address, privateKey };\n    },\n    async sendToAccount(accountTo) {\n      this.busy = true;\n      const { hash, tx: { amount } } = await (\n        await Ae.compose(\n          Transaction, {\n            methods: {\n              sign: data => Promise.resolve(Crypto.sign(data, this.keypair.privateKey)),\n              address: () => Promise.resolve(this.keypair.address),\n            },\n          },\n        )({ url: this.$store.state.sdkUrl })\n      )\n        .transferFunds(1, accountTo);\n      this.$router.push({ name: 'transfer' });\n      this.$store.dispatch('modals/open', {\n        name: 'spendSuccess',\n        transactionHash: hash,\n        amount: BigNumber(amount).shiftedBy(-MAGNITUDE),\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../styles/typography';\n\n.spinner {\n  flex-grow: 1;\n  display: flex;\n\n  .ae-spinner {\n    margin: auto;\n  }\n}\n\n.redeem-balance .balance-row {\n  display: flex;\n  justify-content: space-between;\n  @extend %face-sans-base;\n}\n</style>\n"],"sourceRoot":""}